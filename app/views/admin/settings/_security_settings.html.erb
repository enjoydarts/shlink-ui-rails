<!-- Security設定 -->
<% if @settings_by_category['security'] %>
  <div class="card p-6">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-xl font-bold text-gray-900">🔒 Security設定</h2>
      <div class="flex space-x-2">
        <button type="button" onclick="resetCategory('security')"
                class="bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded text-sm">
          リセット
        </button>
      </div>
    </div>
    
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">
          パスワード最小長
        </label>
        <% password_min = @settings_by_category['security']['security.password_min_length'] %>
        <%= form.number_field "settings[security.password_min_length]", 
            value: password_min&.value,
            placeholder: "8",
            min: "6",
            max: "128",
            class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" %>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">
          セッション有効期限（時間）
        </label>
        <% session_timeout = @settings_by_category['security']['security.session_timeout_hours'] %>
        <%= form.number_field "settings[security.session_timeout_hours]", 
            value: session_timeout&.value,
            placeholder: "24",
            min: "1",
            max: "168",
            class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" %>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">
          ログイン失敗回数制限
        </label>
        <% max_attempts = @settings_by_category['security']['security.max_login_attempts'] %>
        <%= form.number_field "settings[security.max_login_attempts]", 
            value: max_attempts&.value,
            placeholder: "5",
            min: "3",
            max: "20",
            class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" %>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">
          アカウントロック時間（分）
        </label>
        <% lockout_time = @settings_by_category['security']['security.account_lockout_time'] %>
        <%= form.number_field "settings[security.account_lockout_time]", 
            value: lockout_time&.value,
            placeholder: "30",
            min: "5",
            max: "1440",
            class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" %>
      </div>


      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">
          強固なパスワード要求
        </label>
        <% strong_password = @settings_by_category['security']['security.require_strong_password'] %>
        <%= form.select "settings[security.require_strong_password]",
            options_for_select([
              ['有効', 'true'],
              ['無効', 'false']
            ], strong_password&.typed_value.to_s),
            {},
            { class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" } %>
      </div>


    </div>
  </div>
<% end %>